###MILITARY AI###

division_limiter = {
	allowed = {
		NOT = { has_game_rule = { rule = unit_limit_options option = NONE } }
	}
	enable = {
		has_reached_maximum_divisions = yes
	}

	abort_when_not_enabled = yes

	#AI roles
	ai_strategy = { type = build_army 	id = infantry			value = -1000 }
	ai_strategy = { type = build_army 	id = shock_infantry		value = -1000 }
	ai_strategy = { type = build_army 	id = motorized			value = -1000 }
	ai_strategy = { type = build_army 	id = mechanized			value = -1000 }
	ai_strategy = { type = build_army	id = armor_role			value = -1000 }
	ai_strategy = { type = build_army 	id = heavy_armor_role		value = -1000 }
	ai_strategy = { type = build_army 	id = tank_destroyer_role	value = -1000 }
	ai_strategy = { type = build_army 	id = marine			value = -1000 }
	ai_strategy = { type = build_army 	id = mountaineer		value = -1000 }
	ai_strategy = { type = build_army 	id = suppression		value = -1000 }
	ai_strategy = { type = build_army 	id = bicycle			value = -1000 }
	ai_strategy = { type = build_army 	id = elite_infantry		value = -1000 }
	ai_strategy = { type = build_army 	id = RR_Werwolf			value = -1000 }
	ai_strategy = { type = build_army 	id = armour_super_heavy		value = -1000 }
	ai_strategy = { type = build_army 	id = armour_landcruiser		value = -1000 }
}

############################################################################################################
#	ROLE RATIOS: INFANTRY
############################################################################################################

infantry_effort = {
	enable = {
		ai_has_role_template = infantry
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = 100 }
}

shock_infantry_effort = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = -25 }
	ai_strategy = { type = role_ratio                          id = shock_infantry               value = 25 }
}

sm_mode_more_shock_inf = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		has_global_flag = SpaceMarines
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = -10 }
	ai_strategy = { type = role_ratio                          id = shock_infantry               value = 10 }
}

motorized_infantry_effort = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = motorized
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = -15 }
	ai_strategy = { type = role_ratio                          id = motorized                    value = 15 }
}

mw_more_mot = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		ai_has_role_template = motorized
		has_doctrine = new_mobile_warfare
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = shock_infantry               value = -5 }
	ai_strategy = { type = role_ratio                          id = motorized                    value = 5 }
}

sp_more_shock_inf = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		ai_has_role_template = motorized
		has_doctrine = superior_firepower
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = shock_infantry               value = 5 }
	ai_strategy = { type = role_ratio                          id = motorized                    value = -5 }
}

ma_more_inf = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		ai_has_role_template = motorized
		has_doctrine = mass_assault
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = 10 }
	ai_strategy = { type = role_ratio                          id = shock_infantry               value = -5 }
	ai_strategy = { type = role_ratio                          id = motorized                    value = -5 }
}

mechanized_infantry_effort = {
	enable = {
		is_eligible_for_improved_armor_production = yes
		ai_has_role_template = shock_infantry
		ai_has_role_template = motorized
		ai_has_role_template = mechanized
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = -10 }
	ai_strategy = { type = role_ratio                          id = shock_infantry               value = -5 }
	ai_strategy = { type = role_ratio                          id = motorized                    value = -5 }
	ai_strategy = { type = role_ratio                          id = mechanized               	 value = 20 }
}

ma_less_mech = {
	enable = {
		is_eligible_for_improved_armor_production = yes
		ai_has_role_template = motorized
		ai_has_role_template = mechanized
		has_doctrine = mass_assault
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = motorized                    value = 10 }
	ai_strategy = { type = role_ratio                          id = mechanized               	 value = -10 }
}

############################################################################################################
#	ROLE RATIOS: ARMOR
############################################################################################################

medium_armor_effort = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = armor_role
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = armor_role             		 value = 35 }
}

ma_less_tanks = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = armor_role
		has_doctrine = mass_assault
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = armor_role             		 value = -10 }
}

heavy_armor_effort = {
	enable = {
		is_eligible_for_heavy_armor_production = yes
		ai_has_role_template = heavy_armor_role
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = heavy_armor_role             value = 15 }
}

ma_less_heavy_tanks = {
	enable = {
		is_eligible_for_heavy_armor_production = yes
		ai_has_role_template = armor_role
		ai_has_role_template = heavy_armor_role
		has_doctrine = mass_assault
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = armor_role             		 value = 5 }
	ai_strategy = { type = role_ratio                          id = heavy_armor_role             value = -5 }
}

gbp_more_heavy_tanks = {
	enable = {
		is_eligible_for_heavy_armor_production = yes
		ai_has_role_template = armor_role
		ai_has_role_template = heavy_armor_role
		has_doctrine = grand_battleplan
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = armor_role             		 value = -5 }
	ai_strategy = { type = role_ratio                          id = heavy_armor_role             value = 5 }
}

tank_destroyer_effort = {
	enable = {
		is_eligible_for_improved_heavy_armor_production = yes
		ai_has_role_template = tank_destroyer_role
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = tank_destroyer_role          value = 5 }
}

mw_more_td = {
	enable = {
		is_eligible_for_improved_heavy_armor_production = yes
		ai_has_role_template = heavy_armor_role
		ai_has_role_template = tank_destroyer_role
		has_doctrine = new_mobile_warfare
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = heavy_armor_role             value = -5 }
	ai_strategy = { type = role_ratio                          id = tank_destroyer_role          value = 5 }
}

more_td_losing_tank_war = {
	enable = {
		is_eligible_for_improved_heavy_armor_production = yes
		ai_has_role_template = tank_destroyer_role
		any_enemy_country = {
			ROOT = {
				estimated_intel_max_armor = {
					tag = PREV
					value > 25
				}
			}
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = tank_destroyer_role          value = 5 }
}

############################################################################################################
#	BUILD ARMY: INFANTRY
############################################################################################################

build_inf_army_1 = {
	enable = {
		ai_has_role_template = infantry
		manpower_per_military_factory > 12000
		has_manpower > 1875000
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = infantry                    	  value = 125 }
}

build_inf_army_2 = {
	enable = {
		ai_has_role_template = infantry
		manpower_per_military_factory > 12000
		has_manpower > 3750000
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = infantry                    	  value = 125 }
}

build_inf_army_3 = {
	enable = {
		ai_has_role_template = infantry
		manpower_per_military_factory > 12000
		has_manpower > 5625000
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = infantry                    	  value = 125 }
}

build_inf_army_4 = {
	enable = {
		ai_has_role_template = infantry
		manpower_per_military_factory > 12000
		has_manpower > 7500000
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = infantry                    	  value = 125 }
}

############################################################################################################
#	BUILD ARMY: SHOCK INFANTRY
############################################################################################################

build_shock_inf_army_1 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		manpower_per_military_factory > 6000
		has_manpower > 375000
		has_army_size = { size > 50 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = shock_infantry                    value = 25 }
}

build_shock_inf_army_2 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		manpower_per_military_factory > 6000
		has_manpower > 750000
		has_army_size = { size > 100 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = shock_infantry                    value = 25 }
}

build_shock_inf_army_3 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		manpower_per_military_factory > 6000
		has_manpower > 1125000
		has_army_size = { size > 150 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = shock_infantry                    value = 25 }
}

build_shock_inf_army_4 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		manpower_per_military_factory > 6000
		has_manpower > 1500000
		has_army_size = { size > 200 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = shock_infantry                    value = 25 }
}

build_shock_inf_army_5 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = shock_infantry
		manpower_per_military_factory > 6000
		has_manpower > 1875000
		has_army_size = { size > 250 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = shock_infantry                    value = 25 }
}

############################################################################################################
#	BUILD ARMY: MOTORIZED
############################################################################################################

build_mot_army_1 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = motorized
		manpower_per_military_factory > 9000
		has_manpower > 375000
		has_army_size = { size > 75 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = motorized                         value = 25 }
}

build_mot_army_2 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = motorized
		manpower_per_military_factory > 9000
		has_manpower > 750000
		has_army_size = { size > 150 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = motorized                         value = 25 }
}

build_mot_army_3 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = motorized
		manpower_per_military_factory > 9000
		has_manpower > 1125000
		has_army_size = { size > 225 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = motorized                         value = 25 }
}

############################################################################################################
#	BUILD ARMY: MECHANIZED
############################################################################################################

build_mech_army_1 = {
	enable = {
		is_eligible_for_improved_armor_production = yes
		ai_has_role_template = mechanized
		manpower_per_military_factory > 4500
		has_manpower > 375000
		has_army_size = { size > 75 type = infantry }
		has_army_size = { size > 15 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = mechanized                     	   value = 25 }
}

build_mech_army_2 = {
	enable = {
		is_eligible_for_improved_armor_production = yes
		ai_has_role_template = mechanized
		manpower_per_military_factory > 4500
		has_manpower > 750000
		has_army_size = { size > 150 type = infantry }
		has_army_size = { size > 30 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = mechanized                     	   value = 25 }
}

build_mech_army_3 = {
	enable = {
		is_eligible_for_improved_armor_production = yes
		ai_has_role_template = mechanized
		manpower_per_military_factory > 4500
		has_manpower > 1125000
		has_army_size = { size > 225 type = infantry }
		has_army_size = { size > 45 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = mechanized                     	   value = 25 }
}

build_mech_army_4 = {
	enable = {
		is_eligible_for_improved_armor_production = yes
		ai_has_role_template = mechanized
		manpower_per_military_factory > 4500
		has_manpower > 1500000
		has_army_size = { size > 300 type = infantry }
		has_army_size = { size > 60 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = mechanized                     	   value = 25 }
}

############################################################################################################
#	BUILD ARMY: ARMOR
############################################################################################################

build_tank_army_1 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = armor_role
		manpower_per_military_factory > 3000
		has_manpower > 525000
		has_army_size = { size > 60 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = armor_role                         value = 35 }
}

build_tank_army_2 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = armor_role
		manpower_per_military_factory > 3000
		has_manpower > 1050000
		has_army_size = { size > 120 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = armor_role                         value = 35 }
}

build_tank_army_3 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = armor_role
		manpower_per_military_factory > 3000
		has_manpower > 1575000
		has_army_size = { size > 180 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = armor_role                         value = 35 }
}

build_tank_army_4 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = armor_role
		manpower_per_military_factory > 3000
		has_manpower > 2100000
		has_army_size = { size > 240 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = armor_role                         value = 35 }
}

build_tank_army_5 = {
	enable = {
		is_eligible_for_armor_production = yes
		ai_has_role_template = armor_role
		manpower_per_military_factory > 3000
		has_manpower > 2625000
		has_army_size = { size > 300 type = infantry }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = armor_role                         value = 35 }
}

############################################################################################################
#	BUILD ARMY: HEAVY ARMOR
############################################################################################################

build_heavy_tank_army_1 = {
	enable = {
		is_eligible_for_heavy_armor_production = yes
		ai_has_role_template = heavy_armor_role
		manpower_per_military_factory > 1500
		has_manpower > 375000
		has_army_size = { size > 90 type = infantry }
		has_army_size = { size > 15 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = heavy_armor_role                   value = 25 }
}

build_heavy_tank_army_2 = {
	enable = {
		is_eligible_for_heavy_armor_production = yes
		ai_has_role_template = heavy_armor_role
		manpower_per_military_factory > 1500
		has_manpower > 750000
		has_army_size = { size > 180 type = infantry }
		has_army_size = { size > 30 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = heavy_armor_role                   value = 25 }
}

build_heavy_tank_army_3 = {
	enable = {
		is_eligible_for_heavy_armor_production = yes
		ai_has_role_template = heavy_armor_role
		manpower_per_military_factory > 1500
		has_manpower > 1125000
		has_army_size = { size > 270 type = infantry }
		has_army_size = { size > 45 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = heavy_armor_role                   value = 25 }
}

build_heavy_td_army = {
	enable = {
		is_eligible_for_improved_heavy_armor_production = yes
		ai_has_role_template = tank_destroyer_role
		manpower_per_military_factory > 3000
		has_manpower > 375000
		has_army_size = { size > 120 type = infantry }
		has_army_size = { size > 30 type = armor }
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = build_army                          id = tank_destroyer_role                value = 25 }
}

############################################################################################################
#	SPECIAL FORCES
############################################################################################################

default_armour_super_heavy_production = {
	allowed = {
		OR = {
			tag = RUS
			is_american_tag = yes
		}
	}
	enable = {
		has_tech = super_heavy_tank_chassis
		num_of_military_factories > 150
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = role_ratio
		id = armour_super_heavy
		value = 5
	}
	ai_strategy = {
		type = equipment_variant_production_factor
		id = super_heavy_tank_chassis
		value = 10
	}
}

default_armour_landcruiser_production = {
	allowed = {
		OR = {
			tag = GER
			tag = GRU
		}
	}
	enable = {
		has_tech = super_heavy_tank_chassis
		num_of_military_factories > 200
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = role_ratio
		id = armour_landcruiser
		value = 5
	}
	ai_strategy = {
		type = equipment_variant_production_factor
		id = land_cruiser_chassis
		value = 10
	}
}

default_mountaineer_production = {	
	enable = {
		has_tech = tech_mountaineers
		has_terrain = mountain
		ai_has_role_template = mountaineer
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = -5 }
	ai_strategy = { type = role_ratio                          id = mountaineer                  value = 5 }
}

land_powers_make_more_mountaineers = {
	allowed = {
		OR = {
			is_chinese_tag = yes
			is_russian_tag = yes
			is_balkan_tag = yes
			tag = FRA
			tag = SWI
			tag = AUS
			tag = TUR
			tag = FIN
			tag = NOR
			tag = MEX
			tag = CHL
		}
	}
	enable = {
		has_tech = tech_mountaineers
		ai_has_role_template = mountaineer
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                     value = -10 }
	ai_strategy = { type = role_ratio                          id = mountaineer                  value = 10 }
}

default_marine_production = {
	enable = {
		has_tech = marines
		is_naval_power = yes
		ai_has_role_template = marine
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                   value = -5 }
	ai_strategy = { type = role_ratio                          id = marine                     value = 5 }
}

naval_powers_make_more_marines = {
	allowed = {
		OR = {
			is_american_tag = yes
			is_commonwealth_tag = yes
			tag = GBR
			tag = ENG
			tag = NFA
			tag = HOL
			tag = DEI
			tag = GER
			tag = GEX
			tag = GEA
			tag = JAP
		}
	}
	enable = {
		has_tech = marines
		ai_has_role_template = marine
	}
	abort_when_not_enabled = yes

	ai_strategy = { type = role_ratio                          id = infantry                   value = -10 }
	ai_strategy = { type = role_ratio                          id = marine                     value = 10 }
}

default_bicycle_production = {
	allowed = {
		OR = {
			original_tag = BEL
			original_tag = HOL
			original_tag = INC
			original_tag = SQI
			original_tag = SRI
			original_tag = SZC
		}
	}
	enable = {
		has_tech = bicycle_infantry
	}
	abort_when_not_enabled = yes 
	
	ai_strategy = {
		type = role_ratio
		id = infantry
		value = -10
	}
	ai_strategy = {
		type = role_ratio
		id = bicycle
		value = 10
	}
	ai_strategy = {
		type = template_prio
		id = bicycle
		value = 50
	}
}

default_elite_infantry_production = {
	enable = {
		has_tech = elite_infantry_tech
	}
	abort_when_not_enabled = yes 
	
	ai_strategy = {
		type = role_ratio
		id = elite_infantry
		value = 20
	}
	ai_strategy = {
		type = template_prio
		id = elite_infantry
		value = 100
	}
}

default_flame_tank_and_support_production = {
	allowed = {
		OR = {
			tag = GER
			tag = GRU
		}
	}
	enable = {
		is_eligible_for_armor_production = yes
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = equipment_production_factor
		id = heavy_tank_flame_chassis
		value = 15
	}
	ai_strategy = {
		type = equipment_production_min_factories
		id = heavy_flame_tank
		value = 1
	}
	ai_strategy = {
		type = equipment_production_factor
		id = armored_support_vehicle
		value = 10
	}
}

############################################################################################################
#	CIVS, MILS AND DOCKS
############################################################################################################

make_civs = {
	allowed = {
		NOT = {
			tag = GER
			tag = GRU
			is_american_tag = yes
		}
	}
	enable = {
		date < 1937.1.1
		has_war = no
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = industrial_complex
		value = 1000
	}
}

make_mils = {
	enable = {
		num_of_civilian_factories > 15
		OR = {
			date > 1937.1.1
			has_war = yes
		}
	}
	abort_when_not_enabled = yes
		
	ai_strategy = {
		type = added_military_to_civilian_factory_ratio
		value = 1000
	}
}

french_mil_buildup = {
	allowed = {
		original_tag = FRA
	}
	enable = {
		OR = {
			has_completed_focus = FRA_plan_prost
			has_completed_focus = FRA_military_buildup_two
		}
		date < 1939.1.1
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = arms_factory
		value = 300
	}
}

german_mil_buildup = {
	allowed = {
		original_tag = GER
	}
	enable = {
		has_completed_focus = GER_black_monday_finish
		date < 1939.1.1
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = arms_factory
		value = 300
	}
}

russian_mil_buildup = {
	allowed = {
		original_tag = RUS
	}
	enable = {
		has_completed_focus = RUS_Rearmament_Programme
		date < 1939.1.1
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = arms_factory
		value = 300
	}
}

island_nations_need_dockyards = {
	allowed = {
		OR = {
			tag = CAN
			tag = ENG
			tag = GBR
			tag = JAP
		}
	}
	enable = {
		num_of_military_factories > 9
		surrender_progress < 0.05
		set_temp_variable = { mil_fact = num_of_naval_factories }
		divide_temp_variable = { mil_fact = num_of_military_factories }
		check_variable = {
			var = mil_fact
			value = 0.60
			compare = less_than
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = dockyard_to_military_factory_ratio
		value = 1000
	}
}

americas_need_dockyards = {
	allowed = {
		is_american_tag = yes
	}
	enable = {
		OR = {
			has_global_flag = USA_civil_war_over_flag
			has_global_flag = USA_civil_war_avoided_flag
		}
		num_of_military_factories > 9
		surrender_progress < 0.05
		set_temp_variable = { mil_fact = num_of_naval_factories }
		divide_temp_variable = { mil_fact = num_of_military_factories }
		check_variable = {
			var = mil_fact
			value = 0.40
			compare = less_than
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = dockyard_to_military_factory_ratio
		value = 1000
	}
}

germany_needs_dockyards = {
	allowed = {
		OR = {
			tag = GER
			tag = GRU
		}
	}
	enable = {
		num_of_military_factories > 9
		surrender_progress < 0.05
		set_temp_variable = { mil_fact = num_of_naval_factories }
		divide_temp_variable = { mil_fact = num_of_military_factories }
		check_variable = {
			var = mil_fact
			value = 0.30
			compare = less_than
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = dockyard_to_military_factory_ratio
		value = 1000
	}
}

other_majors_need_dockyards = {
	allowed = {
		NOT = {
			is_american_tag = yes
			tag = GER
			tag = GRU
			tag = CAN
			tag = ENG
			tag = GBR
			tag = JAP
		}
	}
	enable = {
		is_actual_major = yes
		num_of_military_factories > 9
		surrender_progress < 0.05
		set_temp_variable = { mil_fact = num_of_naval_factories }
		divide_temp_variable = { mil_fact = num_of_military_factories }
		check_variable = {
			var = mil_fact
			value = 0.10
			compare = less_than
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = dockyard_to_military_factory_ratio
		value = 1000
	}
}

minors_need_dockyards = {
	enable = {
		is_actual_major = no
		num_of_military_factories > 9
		surrender_progress < 0.05
		set_temp_variable = { mil_fact = num_of_naval_factories }
		divide_temp_variable = { mil_fact = num_of_military_factories }
		check_variable = {
			var = mil_fact
			value = 0.05
			compare = less_than
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = dockyard_to_military_factory_ratio
		value = 1000
	}
}

######################################
#	REFS AND SILOS
######################################

research_processing_techs_1 = {
	enable = {
		date > 1937.1.1
		has_tech = synth_oil_experiments
		num_of_military_factories > 50
		synthetic_refinery > 5
	}

	ai_strategy = {
		type = research_tech
		id = rubber_processing
		value = 100
	}
}

research_processing_techs_2 = {
	enable = {
		date > 1939.1.1
		has_tech = rubber_processing
		num_of_military_factories > 100
		synthetic_refinery > 15
	}

	ai_strategy = {
		type = research_tech
		id = improved_rubber_processing
		value = 100
	}
}

research_processing_techs_3 = {
	enable = {
		date > 1941.1.1
		has_tech = improved_rubber_processing
		num_of_military_factories > 150
		synthetic_refinery > 20
	}

	ai_strategy = {
		type = research_tech
		id = advanced_rubber_processing
		value = 100
	}
}

research_processing_techs_4 = {
	enable = {
		date > 1943.1.1
		has_tech = advanced_rubber_processing
		num_of_military_factories > 200
		synthetic_refinery > 30
	}

	ai_strategy = {
		type = research_tech
		id = modern_rubber_processing
		value = 100
	}
}

majors_build_some_refineries_1 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 30
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 10 } } }
		NOT = { resource_produced@rubber > 10 }
		NOT = { synthetic_refinery > 5 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_2 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 60
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 20 } } }
		NOT = { resource_produced@rubber > 20 }
		NOT = { synthetic_refinery > 10 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_3 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 90
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 30 } } }
		NOT = { resource_produced@rubber > 30 }
		NOT = { synthetic_refinery > 15 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_4 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 120
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 40 } } }
		NOT = { resource_produced@rubber > 40 }
		NOT = { synthetic_refinery > 20 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_5 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 150
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 50 } } }
		NOT = { resource_produced@rubber > 50 }
		NOT = { synthetic_refinery > 25 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_6 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 180
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 60 } } }
		NOT = { resource_produced@rubber > 60 }
		NOT = { synthetic_refinery > 30 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_7 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 210
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 70 } } }
		NOT = { resource_produced@rubber > 70 }
		NOT = { synthetic_refinery > 35 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_8 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 240
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 80 } } }
		NOT = { resource_produced@rubber > 80 }
		NOT = { synthetic_refinery > 40 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_9 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 270
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 90 } } }
		NOT = { resource_produced@rubber > 90 }
		NOT = { synthetic_refinery > 45 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

majors_build_some_refineries_10 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = synth_oil_experiments
		num_of_military_factories > 300
		NOT = { any_subject_country = { check_variable = { resource_produced@rubber > 100 } } }
		NOT = { resource_produced@rubber > 100 }
		NOT = { synthetic_refinery > 50 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 2
	}
}

we_urgently_need_oil_or_rubber = {
	enable = {
		has_war = yes
		has_tech = synth_oil_experiments
		OR = {
			has_fuel < 100
			rubber < 0
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = synthetic_refinery
		value = 10
	}
}

majors_build_some_silos_1 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = fuel_silos
		fuel_silo < 5
		OR = {
			has_navy_size = {size > 75}
			has_deployed_air_force_size = {type = fighter	size > 1500}
			num_of_military_factories > 100
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = fuel_silo
		value = 1
	}
}

majors_build_some_silos_2 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = fuel_silos
		fuel_silo < 10
		OR = {
			has_navy_size = {size > 150}
			has_deployed_air_force_size = {type = fighter	size > 3000}
			num_of_military_factories > 200
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = fuel_silo
		value = 1
	}
}

majors_build_some_silos_3 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = fuel_silos
		fuel_silo < 15
		OR = {
			has_navy_size = {size > 225}
			has_deployed_air_force_size = {type = fighter	size > 4500}
			num_of_military_factories > 300
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = fuel_silo
		value = 1
	}
}

majors_build_some_silos_4 = {
	enable = {
		date > 1938.1.1
		is_actual_major = yes
		has_tech = fuel_silos
		fuel_silo < 20
		OR = {
			has_navy_size = {size > 300}
			has_deployed_air_force_size = {type = fighter	size > 6000}
			num_of_military_factories > 400
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = building_target
		id = fuel_silo
		value = 1
	}
}

######################################
#	MISC
######################################

division_upgrades_are_very_important = {
	enable = {
		always = yes
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = land_xp_spend_priority
		id = division_template
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = infantry
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = cavalry
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = artillery
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = motorized
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = mechanized
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = light_armor
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = medium_armor
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = heavy_armor
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = modern_armor
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = mountaineer
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = marine
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = super_heavy_armor
		value = 100
	}
	ai_strategy = {
		type = template_prio
		id = land_cruiser
		value = 100
	}
}

make_trains = {
	enable = { 
		is_eligible_for_armor_production = yes
	}
	abort_when_not_enabled = yes
	ai_strategy = { type = equipment_production_min_factories_archetype id = train_equipment value = 1 }
}

make_trucks = { 
	enable = { 
		is_eligible_for_armor_production = yes
		has_tech = motorised_infantry
		NOT = {has_tech = mechanised_infantry}
	} 
	abort_when_not_enabled = yes
	ai_strategy = { type = equipment_production_min_factories_archetype id = motorized_equipment value = 3 }
}

always_upgrade_tanks = {
	enable = { always = yes }
	abort_when_not_enabled = yes
	
	ai_strategy = { type = production_upgrade_desire_offset id = light_tank_chassis_1 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = light_tank_chassis_2 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = light_tank_chassis_3 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = medium_tank_chassis_1 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = medium_tank_chassis_2 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = medium_tank_chassis_3 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = heavy_tank_chassis_1 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = heavy_tank_chassis_2 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = heavy_tank_chassis_3 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = modern_tank_chassis value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = super_heavy_tank_chassis_1 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = land_cruiser_chassis_1 value = 100 }
}

always_upgrade_fighters = {
	enable = { always = yes }
	abort_when_not_enabled = yes
	
	ai_strategy = { type = production_upgrade_desire_offset id = small_plane_airframe_1 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = small_plane_airframe_2 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = small_plane_airframe_3 value = 100 }
	ai_strategy = { type = production_upgrade_desire_offset id = small_plane_airframe_4 value = 100 }
}

we_need_nuclear_reactor = {
	enable = {
		is_special_project_completed = sp:sp_nuclear_reactor
		nuclear_reactor < 10
		num_of_military_factories > 249
	}
	abort_when_not_enabled = yes
	ai_strategy = {
		type = building_target
		id = nuclear_reactor
		value = 10
	}
}

we_need_nuclear_reactor_commercial = {
	enable = {
		is_special_project_completed = sp:sp_commercial_nuclear_reactor
		commercial_nuclear_reactor < 10
		num_of_military_factories > 249
	}
	abort_when_not_enabled = yes
	ai_strategy = {
		type = building_target
		id = commercial_nuclear_reactor
		value = 10
	}
}

default_railway_gun_production = {
	allowed = { has_dlc = "No Step Back" }
	enable = {
		has_tech = railway_gun
		num_divisions > 100
		is_major = yes
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = equipment_production_min_factories
		id = railway_gun
		value = 1
	}
}

default_build_facility_land_powers = {
	allowed = {
		OR = {
			tag = GRU
			tag = RUS
		}
	}
	enable = {
		is_major = yes
		num_of_civilian_factories > 80
		num_of_military_factories > 80
		OR = {
			has_tech = improved_light_tank_chassis
			has_tech = basic_medium_tank_chassis
			has_tech = improved_heavy_tank_chassis
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = build_building
		id = land_facility
		value = 1
	}
	ai_strategy = {
		type = build_building
		id = air_facility
		value = 1
	}
}

default_build_a_lw_facility_minor = {
	enable = {
		is_major = no
		NOT = { has_facility_specialization = specialization_land }
		num_of_civilian_factories > 40
		num_of_military_factories > 40
		OR = {
			has_tech = improved_light_tank_chassis
			has_tech = basic_medium_tank_chassis
			has_tech = improved_heavy_tank_chassis
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = build_building
		id = land_facility
		value = 1
	}
}

default_build_an_air_facility_minor = {
	enable = {
		is_major = no
		NOT = { has_facility_specialization = specialization_air }
		num_of_military_factories > 40
		if = {
			limit = { has_dlc_bba = yes }
			OR = {
				has_tech = basic_small_airframe
				has_tech = basic_medium_airframe
				has_tech = basic_large_airframe
			}
		}
		else = {
			OR = {
				has_tech = fighter1
				has_tech = heavy_fighter1
				has_tech = tactical_bomber1
				has_tech = strategic_bomber1
			}
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = build_building
		id = air_facility
		value = 1
	}
}
